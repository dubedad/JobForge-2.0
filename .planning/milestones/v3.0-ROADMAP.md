# Milestone v3.0: Data Layer Expansion

**Status:** SHIPPED 2026-02-05
**Phases:** 14-16
**Total Plans:** 19

## Overview

Expand the WiQ data layer with TBS Occupational Groups and CAF Careers data, enabling downstream apps (JD Builder Lite, veteran transition tools) to query governed gold models instead of scraping.

## Phases

### Phase 14: OG Core

**Goal**: TBS Occupational Groups scraping, gold tables, NOC concordance
**Depends on**: Phase 13 (v2.1 completed)
**Plans**: 7 plans

Plans:
- [x] 14-01: TBS OG scraper models and infrastructure
- [x] 14-02: TBS OG scraper implementation with bilingual support
- [x] 14-03: OG dimension tables (dim_og, dim_og_subgroup)
- [x] 14-04: Pay rates scraper and fact table
- [x] 14-05: Qualification standards dimension table
- [x] 14-06: NOC-OG concordance matching with fuzzy matching
- [x] 14-07: Keyword boosting fix for semantic matching gaps

**Delivered:**
- dim_og (31 groups)
- dim_og_subgroup (111 subgroups)
- dim_og_qualifications (75 qualification standards)
- fact_og_pay_rates (991 pay rates)
- bridge_noc_og (2,486 NOC-OG mappings)

### Phase 15: CAF Core

**Goal**: CAF Careers scraping, gold tables, bridges to NOC/JA
**Depends on**: Phase 14 (OG patterns established)
**Plans**: 6 plans

Plans:
- [x] 15-01: CAF scraper models and listing page parser
- [x] 15-02: CAF career detail scraper with bilingual content
- [x] 15-03: CAF gold table ingestion (dim_caf_occupation, dim_caf_job_family)
- [x] 15-04: CAF-NOC bridge table with fuzzy matching
- [x] 15-05: CAF-JA bridge table with two-level matching
- [x] 15-06: Integration tests and CLI commands

**Delivered:**
- dim_caf_occupation (88 military careers)
- dim_caf_job_family (11 job families)
- bridge_caf_noc (880 CAF-NOC mappings)
- bridge_caf_ja (880 CAF-JA mappings)
- CLI: `jobforge caf refresh`, `jobforge caf status`

### Phase 16: Extended Metadata

**Goal**: Qualification standards, job evaluation, training, governance
**Depends on**: Phase 15 (CAF tables for training data)
**Plans**: 6 plans

Plans:
- [x] 16-01: Enhanced qualification standards with structured fields
- [x] 16-02: Job evaluation standards table
- [x] 16-03: Extended pay rates with represented rates
- [x] 16-04: OG allowances table
- [x] 16-05: CAF training tables
- [x] 16-06: DMBOK tagging and governance metadata

**Delivered:**
- dim_og_qualification_standard (75 rows with 27 columns)
- dim_og_job_evaluation_standard (145 records)
- fact_og_pay_rates extended (6,765 rows: 5,774 represented + 991 excluded)
- dim_collective_agreement (28 agreements)
- fact_og_allowances (14 records, 5 types)
- fact_caf_training (152 training records)
- dim_caf_training_location (18 bases)
- DMBOK tagging module (110 columns tagged)

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| Fuzzy matching for NOC-OG | No authoritative crosswalk exists | 2,486 matches with confidence scores |
| Keyword boosting | Pure fuzzy matching misclassified some domains | IT, CT, UT, HM now correctly mapped |
| Two-level JA matching | Job family then job title for accuracy | 880 CAF-JA mappings |
| DMBOK tagging | Foundation for v4.0 governance framework | 7 tables tagged |

**Issues Resolved:**

- Software developers mapping to Ship Repair (keyword boosting fix)
- CAF job family inference from detail page patterns
- Pay rate parsing for multiple collective agreements

**Technical Debt Incurred:**

- NOC code leading zero formatting (cosmetic, non-breaking)
- 1 orphan OG code (SR - historical, soft FK)
- 12 CAF occupations without training data (86.4% coverage)

---

**Test Coverage:** 224+ tests added (1,197 total)
**Tables Added:** 14 new gold tables
**Relationships Added:** 9 FK relationships

---

*For current project status, see .planning/ROADMAP.md*

---
*Archived: 2026-02-05 as part of v3.0 milestone completion*
