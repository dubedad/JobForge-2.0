# Milestone v2.0: Self-Imputing Model + Live Demo

**Status:** ✅ SHIPPED 2026-01-20
**Phases:** 6-10
**Total Plans:** 11

## Overview

v2.0 enables WiQ to impute its own missing data through hierarchical inheritance, O*NET API integration, and LLM calls — all with full provenance. The milestone culminates in a live demo via MCP showing Power BI building the model in real-time, plus compliance logs demonstrating DADM/DAMA observability and a conversational interface for querying data and metadata.

## Phases

### Phase 6: Imputation Foundation
**Goal**: Users can impute missing attribute values using hierarchical inheritance from authoritative sources
**Depends on**: Phase 5 (v1.0 complete)
**Requirements**: IMP-01, IMP-02
**Plans**: 2 plans

Plans:
- [x] 06-01-PLAN.md — Port NOC resolution service with Pydantic models and validation tests
- [x] 06-02-PLAN.md — Implement hierarchical attribute inheritance with provenance tracking

**Details:**
- 5-tier NOC resolution: DIRECT_MATCH (1.00), EXAMPLE_MATCH (0.95), UG_DOMINANT (0.85), LABEL_IMPUTATION (0.60), UG_IMPUTATION (0.40)
- L5 attribute inheritance via unit_group_id join with provenance columns
- rapidfuzz WRatio for fuzzy matching with 70 threshold

### Phase 7: External Data Integration
**Goal**: Users can enrich WiQ with O*NET attributes and TBS occupational group metadata
**Depends on**: Phase 6
**Requirements**: IMP-03, IMP-04, SRC-01, SRC-02, SRC-03
**Plans**: 3 plans

Plans:
- [x] 07-01-PLAN.md — O*NET API integration with NOC-SOC crosswalk and attribute adapter
- [x] 07-02-PLAN.md — LLM-powered attribute imputation service with structured outputs
- [x] 07-03-PLAN.md — TBS scraping with bilingual support and schema extension

**Details:**
- NOCSOCCrosswalk: 1,467 mappings from Brookfield/thedaisTMU, covers all 515 NOC unit groups
- ONetClient: Async HTTP client with X-API-Key auth, tenacity retry logic
- AttributeImputationService: OpenAI Structured Outputs with gpt-4o-2024-08-06
- TBSScraper: 217 occupational groups, 307 linked pages (EN/FR), full provenance

### Phase 8: Description Generation
**Goal**: Users can generate descriptions for job titles, families, and functions from multiple sources with clear provenance
**Depends on**: Phase 7
**Requirements**: IMP-05, IMP-06
**Plans**: 2 plans

Plans:
- [x] 08-01-PLAN.md — Description models and source cascade logic
- [x] 08-02-PLAN.md — DescriptionGenerationService with NOC-style prompts

**Details:**
- Source cascade: AUTHORITATIVE lead statement → LLM fallback
- 900 lead statements from element_lead_statement.parquet cached with lru_cache
- NOC boundary words in prompts: unit group title, definition, labels

### Phase 9: Demo Infrastructure
**Goal**: Users can run live demo showing Power BI building WiQ model in real-time via MCP
**Depends on**: Phase 8
**Requirements**: MCP-01, MCP-02, MCP-03
**Plans**: 2 plans

Plans:
- [x] 09-01-PLAN.md — MCP configuration and SSE backend for live streaming
- [x] 09-02-PLAN.md — Wizard UI with bilingual support and real-time updates

**Details:**
- 14 MCP Power BI permissions in settings.local.json
- DemoOrchestrator: narration-only, yields SSE events (START, TABLE, RELATIONSHIP, COMPLETE)
- Wizard UI: 4-step flow, GC FIP colors, WCAG 2.1 AA accessible, EN/FR toggle

### Phase 10: Governance and Conversational Interface
**Goal**: Users can demonstrate compliance via traceability logs and query data/metadata conversationally
**Depends on**: Phase 9
**Requirements**: GOV-02, GOV-03, GOV-04, GOV-05, GOV-06
**Plans**: 2 plans (Orbit integration deferred to v3.0)

Plans:
- [x] 10-01-PLAN.md — Compliance logs (DADM, DAMA, Classification RTM models and CLI)
- [x] 10-02-PLAN.md — JobForge HTTP API (data query with Claude, metadata query endpoints)

**Details:**
- DADM compliance: 6.1-6.6 mapped, 100% applicable compliance (3/3)
- DAMA compliance: 11 knowledge areas mapped, 100% applicable compliance (9/9)
- DataQueryService: Claude text-to-SQL with Structured Outputs
- MetadataQueryService: Extended LineageQueryEngine with catalogue patterns
- FastAPI endpoints: /api/query/data, /api/query/metadata, /api/compliance/{framework}

---

## Milestone Summary

**Key Decisions:**

| ID | Decision | Rationale |
|----|----------|-----------|
| 06-01-D1 | Use dataclasses for internal types | Internal-only types don't need Pydantic overhead |
| 06-02-D1 | Use 0.85 default confidence for batch | 64% of UGs are single-label |
| 07-01-D1 | Brookfield NOC-SOC crosswalk | MIT-licensed, 1,467 validated mappings |
| 07-01-D2 | ONET_CONFIDENCE=0.5 | Lower precedence than authoritative Canadian sources |
| 07-02-D1 | Accept ALL LLM responses | Store for downstream filtering |
| 07-02-D2 | Use gpt-4o-2024-08-06 | Structured Outputs support |
| 07-03-D1 | Language-aware validation | TBS pages have French column headers |
| 10-01-D1 | RTM pattern for compliance logs | Industry-standard traceability format |
| 10-01-D2 | Mark DADM 6.1, 6.5, 6.6 as NOT_APPLICABLE | WiQ is decision-SUPPORT, not decision-MAKING |
| 10-02-D1 | Claude claude-sonnet-4-20250514 for SQL | Structured Outputs guarantee |
| 10-02-D3 | DuckDB views over parquet | Memory-efficient query execution |

**Issues Resolved:**

- f-string format specifier in fallback rationale (06-01)
- Deprecated GroupBy.count API (06-02)
- Brookfield repo URL moved to thedaisTMU (07-01)
- French page validation with language-aware columns (07-03)

**Issues Deferred:**

- Orbit integration (INT-04) — deferred to v3.0

**Technical Debt Incurred:**

- None significant

---

*For current project status, see .planning/ROADMAP.md*
*Archived: 2026-01-20 as part of v2.0 milestone completion*
