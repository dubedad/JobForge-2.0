---
phase: 14-og-core
plan: 07
title: Fix NOC-OG Concordance Keyword Boosting
type: gap_closure
source: 14-UAT.md
created: 2026-02-05
---

# Plan 14-07: Fix NOC-OG Concordance Keyword Boosting

## Gap Being Closed

From UAT Test 5:
- **Truth:** NOC 21231 (Software developers and programmers) should map to IT (Information Technology) as top match
- **Actual:** Maps to Ship Repair Chargehands due to fuzzy string similarity
- **Root Cause:** Pure fuzzy matching (rapidfuzz WRatio) lacks semantic awareness

## Approach

Add keyword-based boosting to `_compute_similarity()` that recognizes semantic relationships between NOC titles and OG groups. When NOC title contains domain-specific keywords, boost the score for the corresponding OG group.

## Tasks

### Task 1: Add keyword boosting to concordance matching

**Files:** `src/jobforge/concordance/noc_og.py`

**Changes:**
1. Add `KEYWORD_BOOSTS` dict mapping keywords to OG codes with boost values
2. Create `_apply_keyword_boost()` function
3. Modify `_compute_similarity()` to apply keyword boosting after fuzzy score

**Keyword mappings:**
```python
KEYWORD_BOOSTS = {
    # IT-related -> IT (Information Technology)
    ("software", "developer", "programmer", "computer", "systems", "data", "database", "network", "cyber", "web", "cloud", "devops"): ("IT", 0.5),
    # Finance-related -> CT (Comptrollership)
    ("financial", "finance", "accountant", "accounting", "auditor", "budget"): ("CT", 0.4),
    # HR-related -> HM (Human Resources Management)
    ("human resources", "hr manager", "recruitment", "staffing"): ("HM", 0.4),
    # Research-related -> RE (Research)
    ("research", "researcher", "scientist"): ("RE", 0.4),
    # University-related -> UT (University Teaching)
    ("professor", "lecturer", "university", "academic"): ("UT", 0.5),
}
```

**Verification:**
```bash
python -c "
from jobforge.concordance import match_noc_to_og
m = match_noc_to_og('21231', 'Software developers and programmers')
assert m[0].og_code == 'IT', f'Expected IT, got {m[0].og_code}'
print('PASS: Software developers -> IT')
"
```

### Task 2: Add tests for keyword boosting

**Files:** `tests/concordance/test_noc_og.py`

**Add tests:**
1. `test_software_developers_maps_to_it` - verify IT is top match
2. `test_professors_map_to_ut` - verify UT (University Teaching) is top match
3. `test_accountants_map_to_ct` - verify CT (Comptrollership) is top match
4. `test_keyword_boost_does_not_override_exact_match` - verify exact matches still win

**Verification:**
```bash
pytest tests/concordance/test_noc_og.py -v
```

### Task 3: Rebuild bridge_noc_og table

**Files:** `data/gold/bridge_noc_og.parquet`

**Actions:**
1. Delete existing bridge table
2. Regenerate with `build_bridge_noc_og()`
3. Verify IT appears as top match for software-related NOCs

**Verification:**
```bash
python -c "
from jobforge.concordance.noc_og import build_bridge_noc_og
result = build_bridge_noc_og()
print(f'Rebuilt: {result[\"row_count\"]} rows')
"
```

## Success Criteria

- [ ] `match_noc_to_og('21231', 'Software developers and programmers')` returns IT as top match
- [ ] `match_noc_to_og('41200', 'University professors')` returns UT as top match
- [ ] All existing tests still pass
- [ ] New keyword boosting tests pass
- [ ] bridge_noc_og.parquet regenerated with improved mappings

## Risks

- **Over-boosting:** Keywords might override legitimate fuzzy matches
  - Mitigation: Use additive boost (not replacement), cap total score at 1.0
- **Missing keywords:** Some NOC titles may still map poorly
  - Mitigation: This is iterative; add more keywords as discovered

## Estimated Scope

- Lines of code: ~50
- Files modified: 2
- Tests added: 4
