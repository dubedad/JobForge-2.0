---
phase: 09-demo-infrastructure
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - src/jobforge/demo/static/index.html
  - src/jobforge/demo/static/css/main.css
  - src/jobforge/demo/static/css/gc-theme.css
  - src/jobforge/demo/static/css/a11y.css
  - src/jobforge/demo/static/js/main.js
  - src/jobforge/demo/static/js/wizard.js
  - src/jobforge/demo/static/js/sse.js
  - src/jobforge/demo/static/js/i18n.js
  - src/jobforge/demo/static/locales/en.json
  - src/jobforge/demo/static/locales/fr.json
autonomous: false

must_haves:
  truths:
    - "User sees TurboTax-style wizard with 4 steps"
    - "User can switch between English and French"
    - "Real-time deployment progress displays via SSE"
    - "Wizard is keyboard navigable and WCAG 2.1 AA compliant"
    - "Split screen demo works with Power BI"
  artifacts:
    - path: "src/jobforge/demo/static/index.html"
      provides: "Main wizard UI structure"
      contains: "wizard-step"
    - path: "src/jobforge/demo/static/js/wizard.js"
      provides: "Wizard step navigation"
      exports: ["WizardController"]
    - path: "src/jobforge/demo/static/js/sse.js"
      provides: "SSE client wrapper"
      exports: ["DeploymentStream"]
    - path: "src/jobforge/demo/static/locales/en.json"
      provides: "English strings"
    - path: "src/jobforge/demo/static/locales/fr.json"
      provides: "French strings"
  key_links:
    - from: "src/jobforge/demo/static/js/main.js"
      to: "src/jobforge/demo/static/js/wizard.js"
      via: "WizardController instantiation"
      pattern: "new WizardController"
    - from: "src/jobforge/demo/static/js/main.js"
      to: "src/jobforge/demo/static/js/sse.js"
      via: "DeploymentStream instantiation"
      pattern: "new DeploymentStream"
    - from: "src/jobforge/demo/static/js/sse.js"
      to: "/api/deploy/stream"
      via: "EventSource connection"
      pattern: "EventSource"
---

<objective>
Create browser-based wizard UI with bilingual support and real-time SSE deployment streaming.

Purpose: Complete MCP-02 (live demo with split screen) and MCP-03 (basic UI for narration) by delivering an accessible, bilingual wizard interface that displays deployment progress in real-time.

Output: Fully functional web UI with 4-step wizard (Load, Power BI Prompts, Review, Catalogue), real-time deployment progress, EN/FR toggle, and WCAG 2.1 AA compliance.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-demo-infrastructure/09-CONTEXT.md
@.planning/phases/09-demo-infrastructure/09-RESEARCH.md
@.planning/phases/09-demo-infrastructure/09-01-SUMMARY.md

# Backend integration points
@src/jobforge/demo/app.py
@src/jobforge/demo/events.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create HTML Structure and CSS Theme</name>
  <files>
    - src/jobforge/demo/static/index.html
    - src/jobforge/demo/static/css/main.css
    - src/jobforge/demo/static/css/gc-theme.css
    - src/jobforge/demo/static/css/a11y.css
  </files>
  <action>
1. Create `src/jobforge/demo/static/index.html`:
   - DOCTYPE html with lang="en"
   - Meta viewport for responsive design
   - Link to CSS files (gc-theme.css, main.css, a11y.css)
   - Skip link: `<a href="#main-content" class="skip-link">Skip to main content</a>`

   Header:
   - JobForge branding: "Workforce Intelligence / Intelligence de la main-d'oeuvre"
   - Language toggle button: `<button id="lang-toggle" aria-label="Switch to French">FR</button>`
   - Dark mode toggle: `<button id="theme-toggle" aria-label="Toggle dark mode">...</button>`

   Wizard progress nav:
   - `<nav aria-label="Wizard progress">` with ordered list
   - 4 steps: Load, Power BI, Review, Catalogue
   - Each step: `<li class="step" data-step="N">` with step number and label
   - Use data-i18n attributes for bilingual text

   Main content area:
   - `<main id="main-content" role="main">`
   - 4 wizard step fieldsets (only one visible at a time):

   Step 1 (Load):
   - Directory/folder selection (input type="text" with browse hint)
   - "Load Data" button
   - Loading indicator (hidden initially)

   Step 2 (Power BI Prompts):
   - Instructions for user to respond to Power BI dialogs
   - Real-time activity log showing SSE events:
     - `<div class="activity-log" aria-live="polite">` for screen reader announcements
     - Current step prominent, last 3-5 steps faded
   - Live counters: Tables (X/Y), Relationships (X/Y)
   - Progress bar

   Step 3 (Review):
   - Data quality visual placeholder
   - Traceability summary (sources represented, provenance info)
   - Refresh/reload option

   Step 4 (Catalogue):
   - Prompt to create DAMA DMBOK-compliant catalogue
   - Export to CSV button
   - Completion summary

   Footer:
   - Navigation buttons: Back / Next (or step-specific actions)
   - `<div aria-live="polite" id="announcements" class="visually-hidden">` for screen reader

2. Create `src/jobforge/demo/static/css/gc-theme.css`:
   - CSS custom properties for GC colors:
     ```css
     :root {
       --gc-red: #eb2d37;           /* FIP Red */
       --gc-white: #ffffff;
       --gc-black: #000000;
       --gc-pewter: #969696;
       --gc-text: #333333;
       --gc-accent: #26374a;
       --gc-link: #284162;
       --gc-link-hover: #0535d2;
       --gc-link-visited: #7834bc;
       --gc-error: #d3080c;
       --bg-primary: var(--gc-white);
       --text-primary: var(--gc-text);
     }
     @media (prefers-color-scheme: dark) { ... dark mode overrides ... }
     [data-theme="dark"] { ... manual dark mode ... }
     ```
   - GC-compliant color usage for text, links, buttons, borders

3. Create `src/jobforge/demo/static/css/main.css`:
   - Apple-style clean aesthetic: generous whitespace, subtle shadows
   - Wizard layout: centered content, max-width 800px
   - Step indicators: horizontal breadcrumb, circles with numbers
   - Step content: card-like appearance with subtle border
   - Activity log: scrollable, newest at top, older items faded
   - Live counters: inline badges
   - Progress bar: slim, GC-red fill
   - Buttons: rounded corners, GC-accent background, white text
   - Responsive: stack vertically on mobile (< 768px)
   - Split screen support: allow resizing via CSS flexbox

4. Create `src/jobforge/demo/static/css/a11y.css`:
   - .visually-hidden class (screen reader only)
   - .skip-link styling (visible on focus)
   - Focus indicators:
     ```css
     :focus-visible {
       outline: 3px solid var(--gc-link-hover);
       outline-offset: 2px;
     }
     ```
   - High contrast mode support: `@media (forced-colors: active) { ... }`
   - Reduced motion: `@media (prefers-reduced-motion: reduce) { ... }`
  </action>
  <verify>
    - Open index.html directly in browser (file://) - basic structure visible
    - Verify GC colors applied (red header accent, dark text)
    - Tab through page - focus indicators visible
    - Test with browser zoom 200% - content scales properly
  </verify>
  <done>HTML structure and GC-compliant CSS theme complete</done>
</task>

<task type="auto">
  <name>Task 2: Implement JavaScript Wizard and SSE Integration</name>
  <files>
    - src/jobforge/demo/static/js/wizard.js
    - src/jobforge/demo/static/js/sse.js
    - src/jobforge/demo/static/js/i18n.js
    - src/jobforge/demo/static/js/main.js
    - src/jobforge/demo/static/locales/en.json
    - src/jobforge/demo/static/locales/fr.json
  </files>
  <action>
1. Create `src/jobforge/demo/static/js/wizard.js`:
   - WizardController class:
     ```javascript
     class WizardController {
       constructor() {
         this.currentStep = 1;
         this.totalSteps = 4;
         this.steps = document.querySelectorAll('.wizard-step');
         this.progressItems = document.querySelectorAll('.wizard-progress .step');
         this.announcer = document.getElementById('announcements');
       }

       goToStep(stepNumber) { ... }  // Hide all, show target, update progress, focus management
       next() { ... }
       previous() { ... }
       canProceed() { ... }  // Validation for current step
       announce(message) { ... }  // Screen reader announcement
     }
     ```
   - Focus management: move focus to first interactive element when step changes
   - Keyboard support: Enter on buttons, Escape to cancel

2. Create `src/jobforge/demo/static/js/sse.js`:
   - DeploymentStream class:
     ```javascript
     class DeploymentStream {
       constructor(url, options = {}) {
         this.url = url;
         this.onStart = options.onStart || (() => {});
         this.onTable = options.onTable || (() => {});
         this.onRelationship = options.onRelationship || (() => {});
         this.onComplete = options.onComplete || (() => {});
         this.onError = options.onError || (() => {});
         this.source = null;
       }

       connect() {
         this.source = new EventSource(this.url);

         this.source.addEventListener('start', (e) => { ... });
         this.source.addEventListener('table', (e) => { ... });
         this.source.addEventListener('relationship', (e) => { ... });
         this.source.addEventListener('complete', (e) => { ... });
         this.source.addEventListener('error', (e) => { ... });

         this.source.onerror = (err) => {
           console.error('SSE error:', err);
           // EventSource auto-reconnects unless explicitly closed
         };
       }

       close() {
         if (this.source) this.source.close();
       }
     }
     ```
   - Parse JSON data from each event
   - Handle reconnection gracefully

3. Create `src/jobforge/demo/static/js/i18n.js`:
   - I18n class:
     ```javascript
     class I18n {
       constructor() {
         this.locale = localStorage.getItem('locale') || 'en';
         this.strings = {};
       }

       async load(locale) { ... }  // Fetch /locales/{locale}.json
       t(key) { ... }              // Dot-notation lookup: "step.load" -> strings.step.load
       apply() { ... }             // Apply to all [data-i18n] elements
       toggle() { ... }            // Switch en <-> fr
     }
     ```
   - Update document.documentElement.lang when locale changes
   - Persist preference to localStorage

4. Create `src/jobforge/demo/static/js/main.js`:
   - Initialize on DOMContentLoaded:
     ```javascript
     document.addEventListener('DOMContentLoaded', async () => {
       const i18n = new I18n();
       await i18n.load(i18n.locale);

       const wizard = new WizardController();

       // Language toggle
       document.getElementById('lang-toggle').addEventListener('click', () => {
         i18n.toggle();
         updateLangToggleLabel();
       });

       // Theme toggle
       document.getElementById('theme-toggle').addEventListener('click', () => {
         toggleTheme();
       });

       // Step navigation buttons
       setupNavigationButtons(wizard);

       // Load button starts deployment
       setupLoadButton(wizard, i18n);
     });
     ```
   - setupLoadButton: When clicked, transition to Step 2 and start SSE stream
   - Update activity log with SSE events
   - Update counters as tables/relationships complete
   - On complete, enable Step 3

5. Create `src/jobforge/demo/static/locales/en.json`:
   ```json
   {
     "app": {
       "title": "JobForge Demo",
       "subtitle": "Workforce Intelligence Platform"
     },
     "step": {
       "load": "Load",
       "powerbi": "Power BI",
       "review": "Review",
       "catalogue": "Catalogue"
     },
     "load": {
       "title": "Load Data",
       "description": "Select the target directory containing your WiQ data.",
       "button": "Load Data",
       "loading": "Loading..."
     },
     "powerbi": {
       "title": "Power BI Building",
       "description": "Watch as JobForge builds your semantic model in Power BI.",
       "tables": "Tables",
       "relationships": "Relationships"
     },
     "review": {
       "title": "Review Model",
       "description": "Review data quality and traceability.",
       "sources": "Data Sources",
       "provenance": "Provenance"
     },
     "catalogue": {
       "title": "Create Catalogue",
       "description": "Generate a DAMA DMBOK-compliant data catalogue.",
       "export": "Export to CSV",
       "complete": "Demo Complete"
     },
     "nav": {
       "back": "Back",
       "next": "Next"
     },
     "a11y": {
       "langToggle": "Switch to French",
       "themeToggle": "Toggle dark mode",
       "skipLink": "Skip to main content"
     }
   }
   ```

6. Create `src/jobforge/demo/static/locales/fr.json`:
   - French translations matching en.json structure
   - Use proper French terminology for GC context
   - "langToggle": "Switch to English"
  </action>
  <verify>
    - Start demo server: `jobforge demo`
    - Open http://localhost:8080 in browser
    - Click FR button - UI switches to French
    - Click EN/FR again - switches back
    - Verify localStorage persists preference on refresh
    - Tab through entire UI - all interactive elements reachable
  </verify>
  <done>Wizard navigation, SSE integration, and bilingual support functional</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete demo infrastructure:
    1. SSE backend streaming deployment events
    2. Browser-based wizard UI with 4 steps
    3. Real-time activity log showing tables/relationships being created
    4. Bilingual EN/FR support
    5. WCAG 2.1 AA accessibility features
    6. GC color palette and clean Apple-style interface
  </what-built>
  <how-to-verify>
    1. Start demo server:
       ```
       jobforge demo
       ```

    2. Open http://localhost:8080 in browser

    3. Verify Step 1 (Load):
       - Clean interface with GC branding
       - "Load Data" button visible
       - Language toggle (FR) in header

    4. Click "Load Data" to start deployment:
       - Transitions to Step 2
       - Activity log shows real-time events
       - Counters update (Tables: X/Y, Relationships: X/Y)
       - Progress bar fills

    5. When deployment completes:
       - "Next" button enabled
       - Can proceed to Step 3 (Review)

    6. Navigate through Steps 3-4:
       - Review shows sources and provenance summary
       - Catalogue step shows export option

    7. Test bilingual:
       - Click FR - entire UI switches to French
       - Refresh page - French persists
       - Click EN - back to English

    8. Test accessibility:
       - Tab through entire UI - focus indicators visible
       - Use screen reader - announcements heard on step change
       - Test with browser zoom 200%

    9. Test split screen:
       - Open Power BI Desktop alongside browser
       - Verify layout works in split view
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to address</resume-signal>
</task>

</tasks>

<verification>
1. `jobforge demo` starts server without errors
2. Browser loads UI at http://localhost:8080
3. Wizard has 4 steps with progress indicator
4. SSE stream shows deployment events in real-time
5. EN/FR toggle works with localStorage persistence
6. Keyboard navigation reaches all interactive elements
7. Focus indicators visible on all focusable elements
8. Screen reader announces step changes
9. Split screen layout functional with Power BI
</verification>

<success_criteria>
- MCP-02 satisfied: `/stagegold` triggerable via MCP, shows Power BI building live
- MCP-03 satisfied: Basic UI displays narration of what JobForge is doing
- Success Criterion 3: Basic UI displays narration during demo
- Success Criterion 4: Split screen demo works
- Bilingual (EN/FR) with Official Languages Act compliance
- WCAG 2.1 AA compliant
</success_criteria>

<output>
After completion, create `.planning/phases/09-demo-infrastructure/09-02-SUMMARY.md`
</output>
