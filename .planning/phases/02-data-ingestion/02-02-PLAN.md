---
phase: 02-data-ingestion
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - src/jobforge/ingestion/oasis.py
  - src/jobforge/ingestion/element.py
  - tests/test_noc_attributes_ingestion.py
  - data/gold/oasis_skills.parquet
  - data/gold/element_main_duties.parquet
autonomous: true

must_haves:
  truths:
    - "NOC Oasis attribute tables exist in gold with proficiency scores"
    - "NOC Element attribute tables exist in gold with text descriptions"
    - "All attribute tables have unit_group_id linking to DIM NOC"
    - "All attribute tables have noc_element_code derived from OaSIS code"
  artifacts:
    - path: "src/jobforge/ingestion/oasis.py"
      provides: "OASIS attribute table ingestion with proficiency scores"
      exports: ["ingest_oasis_table", "OASIS_TABLES"]
    - path: "src/jobforge/ingestion/element.py"
      provides: "Element attribute table ingestion with text descriptions"
      exports: ["ingest_element_table", "ELEMENT_TABLES"]
    - path: "data/gold/oasis_skills.parquet"
      provides: "Skills table with proficiency 1-5 ratings per NOC"
      contains: "unit_group_id, noc_element_code, proficiency columns"
  key_links:
    - from: "src/jobforge/ingestion/oasis.py"
      to: "src/jobforge/ingestion/transforms.py"
      via: "derive_unit_group_from_oasis()"
      pattern: "derive_unit_group_from_oasis"
    - from: "data/gold/oasis_skills.parquet"
      to: "data/gold/dim_noc.parquet"
      via: "unit_group_id foreign key"
      pattern: "unit_group_id"
---

<objective>
Ingest NOC attribute tables (OASIS proficiency + Element text) to gold layer.

Purpose: NOC attributes form the "right wing" of the butterfly semantic model. OASIS tables contain proficiency scores (1-5) for skills, abilities, knowledge, etc. Element tables contain text descriptions like main duties and employment requirements. All link to DIM NOC via unit_group_id.

Output:
- ingest_oasis_table() function for proficiency-scored tables
- ingest_element_table() function for text description tables
- Sample tables ingested to gold layer
- Tests verifying foreign key relationship to DIM NOC
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-data-ingestion/02-RESEARCH.md
@.planning/phases/02-data-ingestion/02-01-SUMMARY.md

# Existing transform functions
@src/jobforge/ingestion/transforms.py
@src/jobforge/ingestion/noc.py
@src/jobforge/pipeline/engine.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create OASIS Attribute Ingestion (Proficiency Tables)</name>
  <files>
    src/jobforge/ingestion/oasis.py
    data/source/skills_oasis_sample.csv
  </files>
  <action>
Create OASIS attribute table ingestion for tables with proficiency scores (1-5).

OASIS tables include: skills, abilities, personal-attributes, knowledges, workactivities, workcontext

**Data format (from 02-RESEARCH.md):**
- Column "OaSIS Code - Final": Format XXXXX.YY (e.g., 00010.00)
- Column "OaSIS Label - Final": Occupation label
- Multiple proficiency columns with scores 0-5
- Proficiency columns vary by table (skills has 35, abilities has fewer, etc.)

**src/jobforge/ingestion/oasis.py:**
```python
"""OASIS attribute table ingestion (proficiency-scored tables)."""
from pathlib import Path
from typing import Optional

import polars as pl

from jobforge.pipeline.config import PipelineConfig
from jobforge.pipeline.engine import PipelineEngine
from jobforge.ingestion.transforms import derive_unit_group_from_oasis, derive_noc_element_code


# OASIS tables with proficiency scores (1-5)
OASIS_TABLES = [
    "skills",
    "abilities",
    "personal_attributes",
    "knowledges",
    "workactivities",
    "workcontext",
]


def ingest_oasis_table(
    source_path: Path,
    table_name: str,
    config: Optional[PipelineConfig] = None,
    oasis_code_column: str = "OaSIS Code - Final",
) -> dict:
    """Ingest an OASIS attribute table to gold layer.

    OASIS tables contain proficiency scores (1-5) for various attributes
    per NOC occupation. Each row represents one occupation (by OaSIS code).

    Transforms applied:
    - Bronze: Passthrough (keep original schema)
    - Silver: Derive unit_group_id and noc_element_code from OaSIS code
    - Gold: Keep all columns including proficiency scores

    Args:
        source_path: Path to OASIS CSV file
        table_name: Output table name (e.g., "oasis_skills")
        config: Pipeline configuration (defaults to PipelineConfig())
        oasis_code_column: Column containing OaSIS code (default: "OaSIS Code - Final")

    Returns:
        Dict with gold_path, batch_id, and row counts
    """
    engine = PipelineEngine(config=config)

    # Bronze: minimal schema - just clean column names
    # Keep proficiency columns as-is since they vary by table
    bronze_schema = {
        "rename": {
            oasis_code_column: "oasis_code",
            "OaSIS Label - Final": "oasis_label",
        },
    }

    # Silver transforms: derive FK columns
    def derive_fk_columns(df: pl.LazyFrame) -> pl.LazyFrame:
        """Derive unit_group_id and noc_element_code from oasis_code."""
        return df.with_columns([
            # unit_group_id: first 5 chars, zero-padded
            pl.col("oasis_code")
            .str.slice(0, 5)
            .str.zfill(5)
            .alias("unit_group_id"),
            # noc_element_code: last 2 chars after decimal
            pl.col("oasis_code")
            .str.slice(-2)
            .alias("noc_element_code"),
        ])

    silver_transforms = [derive_fk_columns]

    # Gold: keep all columns, reorder to put FKs first
    def reorder_columns(df: pl.LazyFrame) -> pl.LazyFrame:
        """Reorder columns to put foreign keys first."""
        # Get all column names
        cols = df.collect_schema().names()
        # Define priority columns
        priority = ["unit_group_id", "noc_element_code", "oasis_code", "oasis_label"]
        # Provenance columns
        provenance = ["_source_file", "_ingested_at", "_batch_id", "_layer"]
        # Proficiency columns (everything else)
        proficiency = [c for c in cols if c not in priority and c not in provenance]
        # Final order
        final_order = priority + proficiency + provenance
        return df.select([c for c in final_order if c in cols])

    gold_transforms = [reorder_columns]

    result = engine.run_full_pipeline(
        source_path=source_path,
        table_name=table_name,
        domain="oasis",
        bronze_schema=bronze_schema,
        silver_transforms=silver_transforms,
        gold_transforms=gold_transforms,
    )

    return result


def ingest_all_oasis_tables(
    source_dir: Path,
    config: Optional[PipelineConfig] = None,
) -> dict[str, dict]:
    """Ingest all OASIS tables from a source directory.

    Looks for CSV files matching OASIS table names in source_dir.

    Args:
        source_dir: Directory containing OASIS CSV files
        config: Pipeline configuration

    Returns:
        Dict mapping table name to ingestion result
    """
    results = {}
    for table in OASIS_TABLES:
        # Try common file patterns
        patterns = [
            f"{table}_oasis_*.csv",
            f"oasis_{table}*.csv",
            f"{table}.csv",
        ]
        for pattern in patterns:
            matches = list(source_dir.glob(pattern))
            if matches:
                source_path = matches[0]
                results[table] = ingest_oasis_table(
                    source_path=source_path,
                    table_name=f"oasis_{table}",
                    config=config,
                )
                break
    return results
```

**Create sample OASIS skills CSV for testing:**

**data/source/skills_oasis_sample.csv:**
```csv
OaSIS Code - Final,OaSIS Label - Final,Reading Comprehension,Writing,Numeracy,Digital Literacy,Problem Solving
00010.00,Legislators,4,4,3,4,5
00011.00,Senior government managers,5,5,4,4,5
00012.00,Senior managers - financial,4,4,5,4,5
10010.00,Financial managers,4,4,5,4,4
10011.00,Human resources managers,4,5,3,4,4
```
  </action>
  <verify>
1. `python -c "from jobforge.ingestion.oasis import ingest_oasis_table, OASIS_TABLES; print('Import OK')"`
2. Verify sample CSV exists: `ls data/source/skills_oasis_sample.csv`
3. Test import with sample: `python -c "from jobforge.ingestion.oasis import ingest_oasis_table; from pathlib import Path; r = ingest_oasis_table(Path('data/source/skills_oasis_sample.csv'), 'oasis_skills_test'); print(f'Gold: {r[\"gold_path\"]}')"` (if sample exists)
  </verify>
  <done>
ingest_oasis_table() function created. Derives unit_group_id and noc_element_code from OaSIS code. Sample skills CSV available for testing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Element Attribute Ingestion (Text Tables)</name>
  <files>
    src/jobforge/ingestion/element.py
    data/source/main_duties_element_sample.csv
  </files>
  <action>
Create Element attribute table ingestion for tables with text descriptions.

Element tables include: labels, lead-statement, workplaces-employers, example-titles, main-duties, employment-requirements, additional-information, exclusions

**Data format (from 02-RESEARCH.md):**
- Column "OaSIS profile code": Format XXXXX.YY
- Text description columns (varies by table)
- Multiple rows per occupation (e.g., multiple duties per NOC)

**src/jobforge/ingestion/element.py:**
```python
"""Element attribute table ingestion (text description tables)."""
from pathlib import Path
from typing import Optional

import polars as pl

from jobforge.pipeline.config import PipelineConfig
from jobforge.pipeline.engine import PipelineEngine


# Element tables with text descriptions
ELEMENT_TABLES = [
    "labels",
    "lead_statement",
    "workplaces_employers",
    "example_titles",
    "main_duties",
    "employment_requirements",
    "additional_information",
    "exclusions",
]


def ingest_element_table(
    source_path: Path,
    table_name: str,
    config: Optional[PipelineConfig] = None,
    profile_code_column: str = "OaSIS profile code",
) -> dict:
    """Ingest an Element attribute table to gold layer.

    Element tables contain text descriptions for NOC occupations.
    Unlike OASIS tables, Element tables may have multiple rows per
    occupation (e.g., multiple duty statements per NOC).

    Transforms applied:
    - Bronze: Rename profile code column
    - Silver: Derive unit_group_id and noc_element_code
    - Gold: Final column selection

    Args:
        source_path: Path to Element CSV file
        table_name: Output table name (e.g., "element_main_duties")
        config: Pipeline configuration (defaults to PipelineConfig())
        profile_code_column: Column containing OaSIS profile code

    Returns:
        Dict with gold_path, batch_id, and row counts
    """
    engine = PipelineEngine(config=config)

    # Bronze: rename profile code column
    bronze_schema = {
        "rename": {
            profile_code_column: "oasis_profile_code",
        },
    }

    # Silver transforms: derive FK columns
    def derive_fk_columns(df: pl.LazyFrame) -> pl.LazyFrame:
        """Derive unit_group_id and noc_element_code from profile code."""
        return df.with_columns([
            # unit_group_id: first 5 chars, zero-padded
            pl.col("oasis_profile_code")
            .str.slice(0, 5)
            .str.zfill(5)
            .alias("unit_group_id"),
            # noc_element_code: last 2 chars
            pl.col("oasis_profile_code")
            .str.slice(-2)
            .alias("noc_element_code"),
        ])

    silver_transforms = [derive_fk_columns]

    # Gold: reorder columns
    def reorder_columns(df: pl.LazyFrame) -> pl.LazyFrame:
        """Reorder columns to put foreign keys first."""
        cols = df.collect_schema().names()
        # Priority columns
        priority = ["unit_group_id", "noc_element_code", "oasis_profile_code"]
        # Provenance columns
        provenance = ["_source_file", "_ingested_at", "_batch_id", "_layer"]
        # Text columns (everything else)
        text_cols = [c for c in cols if c not in priority and c not in provenance]
        # Final order
        final_order = priority + text_cols + provenance
        return df.select([c for c in final_order if c in cols])

    gold_transforms = [reorder_columns]

    result = engine.run_full_pipeline(
        source_path=source_path,
        table_name=table_name,
        domain="element",
        bronze_schema=bronze_schema,
        silver_transforms=silver_transforms,
        gold_transforms=gold_transforms,
    )

    return result


def ingest_all_element_tables(
    source_dir: Path,
    config: Optional[PipelineConfig] = None,
) -> dict[str, dict]:
    """Ingest all Element tables from a source directory.

    Args:
        source_dir: Directory containing Element CSV files
        config: Pipeline configuration

    Returns:
        Dict mapping table name to ingestion result
    """
    results = {}
    for table in ELEMENT_TABLES:
        # Try common file patterns
        patterns = [
            f"{table}_element_*.csv",
            f"element_{table}*.csv",
            f"{table.replace('_', '-')}*.csv",
            f"{table}.csv",
        ]
        for pattern in patterns:
            matches = list(source_dir.glob(pattern))
            if matches:
                source_path = matches[0]
                results[table] = ingest_element_table(
                    source_path=source_path,
                    table_name=f"element_{table}",
                    config=config,
                )
                break
    return results
```

**Create sample Element CSV for testing:**

**data/source/main_duties_element_sample.csv:**
```csv
OaSIS profile code,Main Duty
00010.00,Participate in debates on proposed legislation
00010.00,Propose legislation and vote on amendments
00010.00,Represent constituents in government
00011.00,Plan organizational objectives
00011.00,Authorize departmental budgets
00011.00,Coordinate activities with senior officials
10010.00,Develop financial policies
10010.00,Prepare financial reports
```
  </action>
  <verify>
1. `python -c "from jobforge.ingestion.element import ingest_element_table, ELEMENT_TABLES; print('Import OK')"`
2. Verify sample CSV exists: `ls data/source/main_duties_element_sample.csv`
3. Test import with sample: `python -c "from jobforge.ingestion.element import ingest_element_table; from pathlib import Path; r = ingest_element_table(Path('data/source/main_duties_element_sample.csv'), 'element_main_duties_test'); print(f'Gold: {r[\"gold_path\"]}')"` (if sample exists)
  </verify>
  <done>
ingest_element_table() function created. Handles multi-row element tables. Derives unit_group_id and noc_element_code from profile code. Sample main duties CSV available for testing.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Tests and Update Ingestion Module</name>
  <files>
    tests/test_noc_attributes_ingestion.py
    src/jobforge/ingestion/__init__.py
  </files>
  <action>
Create comprehensive tests for NOC attribute ingestion and update the ingestion module exports.

**tests/test_noc_attributes_ingestion.py:**
```python
"""Tests for NOC attribute ingestion (OASIS and Element tables)."""
from pathlib import Path

import polars as pl
import pytest

from jobforge.pipeline.config import PipelineConfig
from jobforge.ingestion.oasis import ingest_oasis_table, OASIS_TABLES
from jobforge.ingestion.element import ingest_element_table, ELEMENT_TABLES


@pytest.fixture
def test_config(tmp_path: Path) -> PipelineConfig:
    """Create a PipelineConfig using temporary directory."""
    return PipelineConfig(data_root=tmp_path / "data")


@pytest.fixture
def sample_oasis_csv(tmp_path: Path) -> Path:
    """Create a sample OASIS skills CSV for testing."""
    csv_path = tmp_path / "skills_oasis.csv"
    csv_content = '''OaSIS Code - Final,OaSIS Label - Final,Reading,Writing,Numeracy
00010.00,Legislators,4,4,3
00011.00,Senior government managers,5,5,4
10010.00,Financial managers,4,4,5
10010.01,Financial managers (variant),4,4,5'''
    csv_path.write_text(csv_content, encoding="utf-8")
    return csv_path


@pytest.fixture
def sample_element_csv(tmp_path: Path) -> Path:
    """Create a sample Element main duties CSV for testing."""
    csv_path = tmp_path / "main_duties.csv"
    csv_content = '''OaSIS profile code,Main Duty
00010.00,Participate in debates
00010.00,Propose legislation
00011.00,Plan objectives
00011.00,Authorize budgets
10010.00,Develop policies'''
    csv_path.write_text(csv_content, encoding="utf-8")
    return csv_path


class TestOasisIngestion:
    """Tests for OASIS attribute ingestion."""

    def test_oasis_tables_list_complete(self) -> None:
        """Verify OASIS_TABLES contains expected tables."""
        expected = ["skills", "abilities", "personal_attributes", "knowledges",
                    "workactivities", "workcontext"]
        for table in expected:
            assert table in OASIS_TABLES

    def test_ingest_oasis_creates_gold_file(
        self,
        sample_oasis_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify ingest_oasis_table creates gold parquet file."""
        result = ingest_oasis_table(
            source_path=sample_oasis_csv,
            table_name="oasis_skills",
            config=test_config,
        )

        assert result["gold_path"].exists()

    def test_oasis_has_unit_group_id(
        self,
        sample_oasis_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify OASIS gold table has unit_group_id derived from OaSIS code."""
        result = ingest_oasis_table(
            source_path=sample_oasis_csv,
            table_name="oasis_skills",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        assert "unit_group_id" in gold_df.columns
        # Check derivation: 00010.00 -> 00010
        row = gold_df.filter(pl.col("oasis_code") == "00010.00")
        assert row["unit_group_id"][0] == "00010"

    def test_oasis_has_noc_element_code(
        self,
        sample_oasis_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify OASIS gold table has noc_element_code derived from OaSIS code."""
        result = ingest_oasis_table(
            source_path=sample_oasis_csv,
            table_name="oasis_skills",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        assert "noc_element_code" in gold_df.columns
        # Check derivation: 00010.00 -> 00, 10010.01 -> 01
        row1 = gold_df.filter(pl.col("oasis_code") == "00010.00")
        assert row1["noc_element_code"][0] == "00"
        row2 = gold_df.filter(pl.col("oasis_code") == "10010.01")
        assert row2["noc_element_code"][0] == "01"

    def test_oasis_preserves_proficiency_columns(
        self,
        sample_oasis_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify proficiency columns are preserved in gold table."""
        result = ingest_oasis_table(
            source_path=sample_oasis_csv,
            table_name="oasis_skills",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        assert "Reading" in gold_df.columns
        assert "Writing" in gold_df.columns
        assert "Numeracy" in gold_df.columns


class TestElementIngestion:
    """Tests for Element attribute ingestion."""

    def test_element_tables_list_complete(self) -> None:
        """Verify ELEMENT_TABLES contains expected tables."""
        expected = ["labels", "main_duties", "employment_requirements",
                    "example_titles", "lead_statement"]
        for table in expected:
            assert table in ELEMENT_TABLES

    def test_ingest_element_creates_gold_file(
        self,
        sample_element_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify ingest_element_table creates gold parquet file."""
        result = ingest_element_table(
            source_path=sample_element_csv,
            table_name="element_main_duties",
            config=test_config,
        )

        assert result["gold_path"].exists()

    def test_element_has_unit_group_id(
        self,
        sample_element_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify Element gold table has unit_group_id."""
        result = ingest_element_table(
            source_path=sample_element_csv,
            table_name="element_main_duties",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        assert "unit_group_id" in gold_df.columns
        assert "00010" in gold_df["unit_group_id"].to_list()

    def test_element_preserves_multiple_rows(
        self,
        sample_element_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify Element tables preserve multiple rows per occupation."""
        result = ingest_element_table(
            source_path=sample_element_csv,
            table_name="element_main_duties",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        # 00010 has 2 duties in sample
        duties_00010 = gold_df.filter(pl.col("unit_group_id") == "00010")
        assert len(duties_00010) == 2

    def test_element_has_provenance(
        self,
        sample_element_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify Element gold table has provenance columns."""
        result = ingest_element_table(
            source_path=sample_element_csv,
            table_name="element_main_duties",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        assert "_source_file" in gold_df.columns
        assert "_layer" in gold_df.columns
        assert gold_df["_layer"][0] == "gold"


class TestAttributeForeignKeys:
    """Tests for foreign key relationships to DIM NOC."""

    def test_oasis_unit_group_ids_valid_format(
        self,
        sample_oasis_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify all unit_group_id values are 5-digit format."""
        result = ingest_oasis_table(
            source_path=sample_oasis_csv,
            table_name="oasis_skills",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        for uid in gold_df["unit_group_id"]:
            assert len(uid) == 5, f"unit_group_id {uid} is not 5 digits"

    def test_element_unit_group_ids_valid_format(
        self,
        sample_element_csv: Path,
        test_config: PipelineConfig,
    ) -> None:
        """Verify all unit_group_id values are 5-digit format."""
        result = ingest_element_table(
            source_path=sample_element_csv,
            table_name="element_main_duties",
            config=test_config,
        )

        gold_df = pl.read_parquet(result["gold_path"])

        for uid in gold_df["unit_group_id"]:
            assert len(uid) == 5, f"unit_group_id {uid} is not 5 digits"
```

**Update src/jobforge/ingestion/__init__.py:**
```python
from jobforge.ingestion.noc import ingest_dim_noc
from jobforge.ingestion.oasis import ingest_oasis_table, ingest_all_oasis_tables, OASIS_TABLES
from jobforge.ingestion.element import ingest_element_table, ingest_all_element_tables, ELEMENT_TABLES
from jobforge.ingestion.transforms import (
    filter_unit_groups,
    derive_unit_group_id,
    normalize_noc_code,
    derive_noc_element_code,
    derive_unit_group_from_oasis,
)

__all__ = [
    # NOC ingestion
    "ingest_dim_noc",
    # OASIS ingestion
    "ingest_oasis_table",
    "ingest_all_oasis_tables",
    "OASIS_TABLES",
    # Element ingestion
    "ingest_element_table",
    "ingest_all_element_tables",
    "ELEMENT_TABLES",
    # Transform functions
    "filter_unit_groups",
    "derive_unit_group_id",
    "normalize_noc_code",
    "derive_noc_element_code",
    "derive_unit_group_from_oasis",
]
```
  </action>
  <verify>
Run: `pytest tests/test_noc_attributes_ingestion.py -v`
Expected: All 12+ tests pass:
- test_oasis_tables_list_complete PASSED
- test_ingest_oasis_creates_gold_file PASSED
- test_oasis_has_unit_group_id PASSED
- test_oasis_has_noc_element_code PASSED
- test_oasis_preserves_proficiency_columns PASSED
- test_element_tables_list_complete PASSED
- test_ingest_element_creates_gold_file PASSED
- test_element_has_unit_group_id PASSED
- test_element_preserves_multiple_rows PASSED
- test_element_has_provenance PASSED
- test_oasis_unit_group_ids_valid_format PASSED
- test_element_unit_group_ids_valid_format PASSED
  </verify>
  <done>
All tests pass. OASIS and Element ingestion verified:
- Both derive unit_group_id and noc_element_code correctly
- OASIS preserves proficiency columns
- Element preserves multiple rows per occupation
- All tables have valid 5-digit unit_group_id format for FK relationship
  </done>
</task>

</tasks>

<verification>
## Phase 2 Plan 02 Verification

### Automated Checks
1. **Import verification:** `python -c "from jobforge.ingestion import ingest_oasis_table, ingest_element_table; print('OK')"`
2. **Test suite:** `pytest tests/test_noc_attributes_ingestion.py -v` - all tests pass
3. **Gold files exist after ingestion with real data:**
   - `ls data/gold/oasis_skills.parquet`
   - `ls data/gold/element_main_duties.parquet`

### Foreign Key Verification
Query to verify FK relationship:
```python
import polars as pl
dim_noc = pl.read_parquet("data/gold/dim_noc.parquet")
oasis_skills = pl.read_parquet("data/gold/oasis_skills.parquet")

# All OASIS unit_group_ids should exist in DIM NOC
noc_ids = set(dim_noc["unit_group_id"])
oasis_ids = set(oasis_skills["unit_group_id"])
orphans = oasis_ids - noc_ids
print(f"Orphan unit_group_ids: {len(orphans)}")  # Should be 0 or small number
```
</verification>

<success_criteria>
1. ingest_oasis_table() function ingests proficiency-scored tables
2. ingest_element_table() function ingests text description tables
3. Both derive unit_group_id from OaSIS code (5-digit zero-padded)
4. Both derive noc_element_code from OaSIS code (2-digit decimal portion)
5. OASIS tables preserve all proficiency columns
6. Element tables preserve multiple rows per occupation
7. All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/02-data-ingestion/02-02-SUMMARY.md`
</output>
