---
phase: 17-governance-compliance-framework
plan: 02
type: tdd
wave: 1
depends_on: []
files_modified:
  - src/jobforge/governance/compliance/scoring.py
  - src/jobforge/governance/compliance/audit.py
  - tests/governance/compliance/test_scoring.py
  - tests/governance/compliance/test_audit.py
autonomous: true

must_haves:
  truths:
    - "Compliance scores have three views: pass/fail, percentage, maturity level"
    - "Scores roll up at element, phase, milestone, and project levels"
    - "GC-aligned DAMA dimension weights are configurable with defaults"
    - "Audit generates quantitative metrics per DAMA dimension"
  artifacts:
    - path: "src/jobforge/governance/compliance/scoring.py"
      provides: "ComplianceScore model and scoring calculator"
      exports: ["MaturityLevel", "ComplianceScore", "ComplianceScorer", "GC_DAMA_WEIGHTS"]
    - path: "src/jobforge/governance/compliance/audit.py"
      provides: "DAMA audit with quantitative metrics"
      exports: ["DAMAAudit", "AuditResult"]
    - path: "tests/governance/compliance/test_scoring.py"
      provides: "Unit tests for scoring logic"
      min_lines: 60
  key_links:
    - from: "src/jobforge/governance/compliance/scoring.py"
      to: "src/jobforge/governance/compliance/models.py"
      via: "import ComplianceStatus"
      pattern: "from.*models import.*ComplianceStatus"
---

<objective>
Create the compliance scoring system with multi-view scores and the DAMA audit engine.

Purpose: Enables quantitative compliance measurement across DAMA dimensions with configurable GC-aligned weights. Supports the three scoring views (pass/fail, percentage, maturity) required by CONTEXT.md decisions.

Output: ComplianceScore model, ComplianceScorer calculator, DAMAAudit engine, GC_DAMA_WEIGHTS defaults.
</objective>

<execution_context>
@C:\Users\Administrator\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Administrator\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/17-governance-compliance-framework/17-CONTEXT.md
@.planning/phases/17-governance-compliance-framework/17-RESEARCH.md
@src/jobforge/governance/compliance/models.py
@src/jobforge/governance/compliance/dama.py
@src/jobforge/catalog/dmbok_tagging.py
</context>

<feature>
  <name>Compliance Scoring and DAMA Audit</name>
  <files>
    src/jobforge/governance/compliance/scoring.py
    src/jobforge/governance/compliance/audit.py
    tests/governance/compliance/test_scoring.py
    tests/governance/compliance/test_audit.py
  </files>
  <behavior>
    MaturityLevel enum (4 levels per CONTEXT.md):
    - INITIAL = "Initial" (L1: ad-hoc, no governance)
    - MANAGED = "Managed" (L2: basic processes)
    - DEFINED = "Defined" (L3: documented standards)
    - OPTIMIZED = "Optimized" (L4/L5: quantified and improving)

    ComplianceScore(BaseModel):
    - scope: str ("element", "phase", "milestone", "project")
    - scope_id: str (e.g., "dim_noc", "phase-17", "v4.0")
    - pass_fail: bool
    - failed_requirements: list[str] = []
    - percentage: float (0.0 to 100.0)
    - maturity: MaturityLevel
    - dimension_scores: dict[str, float] (DAMA dimensions -> scores)
    - weights_applied: dict[str, float]
    - calculated_at: datetime

    GC_DAMA_WEIGHTS: dict[str, float] = {
      "Data Governance": 1.5,
      "Data Architecture": 1.0,
      "Data Modeling and Design": 1.0,
      "Data Storage and Operations": 1.0,
      "Data Security": 1.2,
      "Data Integration and Interoperability": 1.3,
      "Metadata Management": 1.4,
      "Data Quality": 1.3,
      "Reference and Master Data": 1.2,
      "Data Warehousing and Business Intelligence": 0.8,
      "Document and Content Management": 0.7,
    }

    ComplianceScorer:
    - __init__(weights: dict[str, float] | None = None) - uses GC_DAMA_WEIGHTS if None
    - calculate_element_score(element_path: str, mappings: list[PolicyMapping]) -> ComplianceScore
    - calculate_phase_score(phase_id: str, element_scores: list[ComplianceScore]) -> ComplianceScore
    - calculate_milestone_score(milestone_id: str, phase_scores: list[ComplianceScore]) -> ComplianceScore
    - calculate_project_score(milestone_scores: list[ComplianceScore]) -> ComplianceScore
    - _derive_maturity(percentage: float) -> MaturityLevel
      - 0-25%: INITIAL
      - 26-50%: MANAGED
      - 51-75%: DEFINED
      - 76-100%: OPTIMIZED

    DAMAAudit:
    - __init__(config: PipelineConfig, scorer: ComplianceScorer | None = None)
    - run_audit(scope: str = "project") -> AuditResult
    - _collect_evidence() -> dict[str, list[str]] (dimension -> evidence artifacts)
    - _calculate_dimension_scores() -> dict[str, float]

    AuditResult(BaseModel):
    - framework: str = "DAMA DMBOK"
    - framework_version: str = "DAMA-DMBOK2 (2017)"
    - scope: str
    - score: ComplianceScore
    - evidence_by_dimension: dict[str, list[str]]
    - gaps: list[str] (dimensions below threshold)
    - recommendations: list[str] (prioritized by impact/effort)
    - generated_at: datetime
  </behavior>
  <implementation>
    1. Create scoring.py with MaturityLevel enum, ComplianceScore model, GC_DAMA_WEIGHTS
    2. Implement ComplianceScorer with rollup calculations (element -> phase -> milestone -> project)
    3. Implement _derive_maturity using percentage thresholds
    4. Create audit.py with DAMAAudit and AuditResult
    5. DAMAAudit._collect_evidence scans for artifacts (files, row counts, schema presence)
    6. DAMAAudit generates prioritized recommendations based on gap analysis
    7. Update src/jobforge/governance/compliance/__init__.py to export new classes
    8. Write comprehensive tests for scoring logic and audit output
  </implementation>
</feature>

<verification>
```bash
# Run scoring tests
pytest tests/governance/compliance/test_scoring.py -v

# Run audit tests
pytest tests/governance/compliance/test_audit.py -v

# Verify scoring works
python -c "
from jobforge.governance.compliance.scoring import ComplianceScorer, MaturityLevel, GC_DAMA_WEIGHTS
scorer = ComplianceScorer()
print(f'Weights: {len(GC_DAMA_WEIGHTS)} dimensions')
print(f'Governance weight: {GC_DAMA_WEIGHTS[\"Data Governance\"]}')
"

# Verify audit runs
python -c "
from jobforge.governance.compliance.audit import DAMAAudit
from jobforge.pipeline.config import PipelineConfig
config = PipelineConfig()
audit = DAMAAudit(config)
result = audit.run_audit('project')
print(f'Audit score: {result.score.percentage:.1f}%')
print(f'Maturity: {result.score.maturity.value}')
"
```
</verification>

<success_criteria>
- MaturityLevel has 4 levels (Initial, Managed, Defined, Optimized)
- ComplianceScore includes pass_fail, percentage, maturity, and dimension_scores
- GC_DAMA_WEIGHTS has 11 dimensions with TBS-aligned values
- ComplianceScorer calculates rollup scores at all 4 levels
- DAMAAudit produces AuditResult with evidence, gaps, and recommendations
- All tests pass (expect 20+ tests)
</success_criteria>

<output>
After completion, create `.planning/phases/17-governance-compliance-framework/17-02-SUMMARY.md`
</output>
