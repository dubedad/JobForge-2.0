---
phase: 18-data-quality-dashboard
plan: 05
type: execute
wave: 3
depends_on: ["18-03"]
files_modified:
  - src/jobforge/dashboard/__init__.py
  - src/jobforge/dashboard/app.py
  - src/jobforge/dashboard/utils.py
  - src/jobforge/dashboard/components/__init__.py
  - src/jobforge/dashboard/components/radar.py
  - src/jobforge/dashboard/components/traffic_light.py
  - src/jobforge/dashboard/pages/__init__.py
  - src/jobforge/dashboard/pages/summary.py
  - pyproject.toml
autonomous: true
user_setup:
  - service: streamlit
    why: "Dashboard framework requires new dependencies"
    env_vars: []
    dashboard_config: []

must_haves:
  truths:
    - "User can view summary grid with traffic-light status for all tables"
    - "Traffic lights show color and percentage score"
    - "User can search/filter tables by name and domain"
    - "Dashboard is desktop-first optimized"
  artifacts:
    - path: "src/jobforge/dashboard/app.py"
      provides: "Streamlit entrypoint with st.navigation"
      contains: "st.set_page_config"
    - path: "src/jobforge/dashboard/pages/summary.py"
      provides: "Summary grid landing page"
      contains: "traffic_light|st.metric"
    - path: "src/jobforge/dashboard/components/radar.py"
      provides: "Reusable radar chart component"
      contains: "go.Scatterpolar"
    - path: "src/jobforge/dashboard/components/traffic_light.py"
      provides: "Traffic-light indicator component"
      contains: "st.metric"
  key_links:
    - from: "src/jobforge/dashboard/app.py"
      to: "src/jobforge/dashboard/pages/summary.py"
      via: "st.navigation page registration"
      pattern: "st\\.Page|st\\.navigation"
    - from: "src/jobforge/dashboard/pages/summary.py"
      to: "src/jobforge/quality/service.py"
      via: "Loads quality scores for display"
      pattern: "QualityService"
---

<objective>
Create the Streamlit dashboard foundation with summary grid landing page, traffic-light indicators, and radar chart component (DQ-05 base).

Purpose: Users can visually assess data quality at a glance via the summary grid. This is the primary interface for data stewards to monitor quality across all 39 gold tables.

Output: Streamlit app with summary page, traffic-light and radar components, desktop-optimized layout.
</objective>

<execution_context>
@C:\Users\Administrator\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Administrator\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/18-data-quality-dashboard/18-CONTEXT.md
@.planning/phases/18-data-quality-dashboard/18-RESEARCH.md

# Prior plan outputs
@.planning/phases/18-data-quality-dashboard/18-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Streamlit and Plotly Dependencies</name>
  <files>pyproject.toml</files>
  <action>
    Add new dependencies to pyproject.toml under [project.dependencies]:

    ```toml
    streamlit>=1.41.0
    plotly>=6.0.0
    kaleido>=0.2.1
    ```

    These are required for:
    - streamlit: Dashboard framework with st.navigation for multi-page apps
    - plotly: Interactive radar charts with go.Scatterpolar
    - kaleido: Static image export for PDF reports (Plan 06)

    Run: pip install -e . to install new dependencies

    Note: cuallee dependency will be added if not already present for quality validation
  </action>
  <verify>pip install -e . && python -c "import streamlit; import plotly; print('OK')"</verify>
  <done>Streamlit, Plotly, and kaleido dependencies installed</done>
</task>

<task type="auto">
  <name>Task 2: Dashboard App Structure and Components</name>
  <files>
    src/jobforge/dashboard/__init__.py
    src/jobforge/dashboard/app.py
    src/jobforge/dashboard/utils.py
    src/jobforge/dashboard/components/__init__.py
    src/jobforge/dashboard/components/radar.py
    src/jobforge/dashboard/components/traffic_light.py
  </files>
  <action>
    Create dashboard module structure:

    src/jobforge/dashboard/__init__.py:
    - Export main app entry point
    - Export component functions

    src/jobforge/dashboard/app.py:
    - Streamlit entrypoint using st.navigation pattern (from RESEARCH.md)
    - st.set_page_config(page_title="JobForge Data Quality", layout="wide")
    - Define pages: summary (default), detail, compare, trends
    - Session state for selected_tables (cross-page state)
    - ISO date format per CONTEXT.md

    src/jobforge/dashboard/utils.py:
    - format_date(dt) -> str (ISO format: YYYY-MM-DD)
    - load_all_quality_scores() -> list[QualityScore]
    - get_table_domains() -> dict[str, list[str]] (group tables by prefix)
    - Helper for filtering tables

    src/jobforge/dashboard/components/__init__.py:
    - Export radar and traffic_light components

    src/jobforge/dashboard/components/radar.py (from RESEARCH.md Pattern 5):
    - create_radar_chart(table_scores: dict[str, dict[str, float]]) -> go.Figure
    - 9 GC DQMF dimensions on axes
    - fill='toself' for area highlighting
    - Limit 2-3 tables per chart
    - return go.Figure for st.plotly_chart

    src/jobforge/dashboard/components/traffic_light.py (from RESEARCH.md Pattern 6):
    - display_traffic_light(table_name: str, score: float, delta: float | None)
    - Thresholds (from CONTEXT.md - gold table standards):
      - Green: >=95% (production-ready)
      - Yellow: 85-94% (needs attention)
      - Red: <85% (critical)
    - Show emoji indicator + percentage
    - Use st.metric for built-in delta display
  </action>
  <verify>python -c "from jobforge.dashboard.components.radar import create_radar_chart; print('OK')"</verify>
  <done>Dashboard structure created with reusable components</done>
</task>

<task type="auto">
  <name>Task 3: Summary Page Implementation</name>
  <files>
    src/jobforge/dashboard/pages/__init__.py
    src/jobforge/dashboard/pages/summary.py
  </files>
  <action>
    Create summary page (landing page per CONTEXT.md):

    src/jobforge/dashboard/pages/__init__.py:
    - Export page modules

    src/jobforge/dashboard/pages/summary.py:
    - Header: "Data Quality Dashboard" with last updated timestamp
    - Search box: Filter by table name (st.text_input)
    - Filter dropdowns: By domain (dim_, fact_, bridge_, etc.), by score threshold
    - Summary grid using st.columns (responsive grid)
    - Each cell shows traffic_light component for one table
    - Sortable by: overall score, table name
    - Desktop-first layout (CONTEXT.md): Use 4-5 columns on wide screens

    Implementation details:
    - Load scores from QualityService (cache with @st.cache_data)
    - Group tables by domain prefix for filtering
    - Show count: "Showing X of Y tables"
    - Click on table name -> set session state for detail page

    Traffic-light display (from CONTEXT.md):
    - Color indicator (emoji or colored dot)
    - Percentage score (e.g., "78%")
    - Optional sparkline from history (if available)

    Search/filter behavior (from CONTEXT.md):
    - Search by table name (contains match)
    - Filter by domain: dim_, fact_, bridge_, element_, oasis_, cops_
    - Filter by score: All, Green only, Yellow only, Red only
  </action>
  <verify>
    streamlit run src/jobforge/dashboard/app.py --server.headless true &
    sleep 3
    curl -s http://localhost:8501 | grep -q "Data Quality" && echo "OK"
    pkill -f streamlit
  </verify>
  <done>Summary page shows traffic-light grid for all tables with search/filter</done>
</task>

</tasks>

<verification>
```bash
# Verify dependencies
python -c "import streamlit; import plotly; import kaleido; print('Dependencies OK')"

# Verify components
python -c "
from jobforge.dashboard.components.radar import create_radar_chart
from jobforge.dashboard.components.traffic_light import display_traffic_light
print('Components OK')
"

# Run dashboard (manual verification)
streamlit run src/jobforge/dashboard/app.py

# Expected: Browser opens with summary grid showing all tables
```
</verification>

<success_criteria>
- [ ] streamlit, plotly, kaleido dependencies added to pyproject.toml
- [ ] Dashboard app.py uses st.navigation with multi-page structure
- [ ] Summary page shows traffic-light grid for all 39 gold tables
- [ ] Traffic-light shows color + percentage per table
- [ ] Search filters tables by name
- [ ] Domain filter groups tables by prefix
- [ ] Radar chart component creates valid Plotly figure
- [ ] Desktop-first layout with 4-5 column grid
</success_criteria>

<output>
After completion, create `.planning/phases/18-data-quality-dashboard/18-05-SUMMARY.md`
</output>
